name: üìö Renova√ß√£o Autom√°tica de Livros

on:
  workflow_dispatch:
  schedule:
    - cron: '0 12 * * *'  # 09:00 hor√°rio de Bras√≠lia (12:00 UTC)

jobs:
  renovar-livros:
    runs-on: ubuntu-latest

    steps:
      - name: üß© Checkout
        uses: actions/checkout@v4

      - name: üèóÔ∏è Configurar Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: üåé Configurar idioma do sistema (pt_BR)
        run: |
          sudo apt-get update
          sudo apt-get install -y locales
          sudo locale-gen pt_BR.UTF-8
          echo "LANG=pt_BR.UTF-8" | sudo tee -a /etc/default/locale
          echo "LANGUAGE=pt_BR:pt" | sudo tee -a /etc/default/locale
          echo "LC_ALL=pt_BR.UTF-8" | sudo tee -a /etc/default/locale
          export LANG=pt_BR.UTF-8
          export LANGUAGE=pt_BR:pt
          export LC_ALL=pt_BR.UTF-8
          locale

      - name: üì¶ Instalar Google Chrome
        run: |
          sudo apt-get install -y google-chrome-stable || \
          (wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb && \
          sudo apt install -y ./google-chrome-stable_current_amd64.deb)
          google-chrome --version

      - name: üì¶ Instalar depend√™ncias do Python
        run: |
          python -m pip install --upgrade pip
          pip install selenium python-dotenv emoji webdriver-manager

      - name: üöÄ Executar script de renova√ß√£o
        env:
          UCB_EMAIL: ${{ secrets.UCB_EMAIL }}
          UCB_PASS: ${{ secrets.UCB_PASS }}
          LANG: pt_BR.UTF-8
          LANGUAGE: pt_BR:pt
          LC_ALL: pt_BR.UTF-8
          CHROME_LANG: pt-BR
        run: python Biblioteca.py
